\clearpage
\newgeometry{hmargin=2.5cm,vmargin=2cm}

\chapter{Project Contextualization}

	\section{Project Specification}
	
		\subsection{Motivations}
	
		The main goal of this project was to build a \textit{Deep Learning Tracking Robot}. Many tracking
		robots have been implemented in the previous years, few have used the adaptive, versatile, and 
		now standard robotic Middleware \textit{ROS}\footnote{Which stands for \textit{Robot Operating System}.}.
		In addition, even fewer have ventured combining \textit{ROS} and \textit{Deep Learning} techniques.
		\\\indent Why \textit{ROS} precisely? As defined by Anis Kouba in \cite{latexcompanion}, \textit{ROS}
		is an \frstg{} open-source \textit{middleware} \lstg{} that provides a robust and reliable framework 
		to build robots. \textit{ROS} is a voguish tool to create robots with advanced functionalities so much so 
		that it has become the standard to develop robots. \textit{ROS2} is already in part 
		operational. In this project though, 
		it has been decided that the first version of \textit{ROS} will be used since \textit{ROS2} is still 
		in heavy development and \textit{ROS} is better documented than its counterpart.
		\\\indent Why is \textit{Deep Learning} suitable for robotic applications? In general, \textit{AI}
		\footnote{Artificial Intelligence, which comprises \textit{Deep Learning}.}
		is really adapted for critical algorithms, such as embedded codes
		on robots, since the performances are much higher than with traditional implementations. By traditional
		implementations, one could for instance consider iterative algorithms where for a particular task 
		all processes are hand-implemented. The conventional solution 
		that comes to mind regarding tracking is an \textit{RGB} tracking, that is to say an 
		algorithm that tracks the color in a frame\footnote{image.} by applying 
		color filters. \textit{AI} enables much finer and more robust
		implementations since the \textit{model},
		which can be regarded as the applied processes, can evolve by itself through diverse methods such as training.
		 
		\subsection{Requirements}
		
		In order to realize the tracking robot, several requirements had to be met in this
		project. First of all, the robot had to reuse an old \textit{Race Car} platform comprising
		the chassis, the wheels \dots all the mechanics. The platform is the \textit{H1 model}
		of the \textit{monster Car} \cite{datasheet}.
		The brain of the robot, that is to say 
		the embedded computer had to be the \textit{Jetson Nano} designed by \textit{Nvidia} \cite{nano}. By and
		large, to build the tracker the material of the laboratory had to be used as much as 
		possible, and the equipment bought had to remain affordable.
		%TODO image of the old platform rc car
		%TODO image of the jetson nano
	
	\section{Strategy}
	
		\subsection{Different periods}

		Developing a robot is a critical task, and has to be conducted thoroughly. 
		In this regard, \textit{ROS} builds a framework for developing 
		robots in a more organized way. For each task to implement, 
		the work-flow has always been the following: research, simulation, isolated 
		tests, integration.
		\\\indent Before even implementing something and integrating it, one should 
		research all the possibilities that are offered to them. Then one of the 
		easier or maybe most sustainable options could be chosen. Yet, even the
		tests, simulation, and integration has to be thought and foreseen beforehand.
		\\\indent Simulating robots, without depending on the hardware is
		a needed step.	 A specific hardware has always some specificities that
		could hide some issues and unpredictable behaviors. As a matter of fact, 
		simulating algorithms that will be integrated in the robot afterward in 
		a controlled environment prevents any hardware based issue to shadow
		our understanding of the basic implementation of
		the \textit{software}.
		\\\indent Once the simulation is in place, it is then 
		recommended to test the simulation as much as possible in order
		to unveil some detrimental singularities. In the case of the hardware, 
		each component has to be tested independently before integration
		\footnote{Especially, some driver issues are sometimes really 
		hard to pinpoint.}.
		\\\indent The final step is to integrate the work in the robot, and
		to test it to see if the robot behaves as expected or if there 
		is any regression.
		\\\indent A robot is not just a piece of software, it is a system 
		where the interaction of the software and the hardware is by 
		definition the future behavior of the robot.
		
		\subsection{Different aspects}

		The development of a robot encapsulates different areas or type of work.
		In the construction of the tracker, principally two aspects 
		have been tackled, the hardware, and the software.
		\\\indent In the first place, the hardware has to be well-chosen beforehand.
		The motor had to replaced, the \textit{wifi} access had to be added, batteries 
		had to be chosen \dots to fit the requirements of the tracking robot.
		\\\indent In the second place, the sofware has to be implemented. Precisely, 
		the tracking algorithm had to be chosen, and the \textit{ROS} architecture had 
		to be designed.
		\\\indent For the entire project, the philosophy was to try to have 
		a working first prototype as soon as possible. In a nutshell, 
		having a hardware and software which are compatible, and then refining
		the existing platform. Indeed, \textit{ROS} provides here another
		crucial boon, for it enables us to have an evolutive architecture 
		where each part can be replaced easily without 
		undermining the overhaul process. For instance, once 
		an architecture is working, the tracking technique could
		be easily replaced.
		\\\indent Throughout this report, which presents the 
		results of the project, three questions will be answered:
		\begin{itemize}
			\item[\textbullet] How was the hardware selected?
			You can find the answers to 
			this question in the part \vref{hardware}.
			\item[\textbullet] How was the tracking algorithm implemented? Which belongs 
			more to the software. You can find the answers to 
			this question in the section \vref{tracking}.
			\item[\textbullet] How was the \textit{ROS} architecture designed? 
			Which belongs more to the software. You can find the answers to 
			this question in the section \vref{ros}.
		\end{itemize}
		
\chapter{State of the art}

		\introductionLettrine{I}{n} order to build the tracker, the first step was to choose the
		hardware of the robot. Secondly, the \textit{ROS} architecture had to be decided
		and thirdly the tracking algorithm had to be implemented. This part 
		presents a brief overview of different existing projects and solutions 
		that could have been selected throughout the project. All the projects
		presented and listed here will then be compared and the choices
		made will be underpinned in the parts \vref{hardware} and \vref{software}.
		
		\section{Building an electric car}
		
		Several projects have aimed to realize an electric car robot, sometimes autonomous. 
		Having in mind these projects can give some piece of advice on how it is common 
		to design such systems.
		\\\indent Some projects have used the on-board computer \textit{Jetson Nano}. 
		One can name the following robots : \textit{Jetbot} \cite{jetbot}, \textit{Kaya} \cite{kaya}.
		These robots are both designed by \textit{Nvidia}, the designers of the 
		\textit{Jetson} board series\footnote{Jetson Nano, Xavier, TX1, TX2 \dots}. It 
		is notably interesting to take as example their hardware selection since they
		use the same embedded computer the tracker use.
		\\\indent Other \textit{RC-cars}\footnote{\textit{Remote Control Car}.} use other types of embedded computers.
		However, the hardware architecture with regard to \textit{RC-cars} is 
		almost always the same. With either the \textit{DeepRacer} of \textit{Amazon} \cite{deepracer}, or
		the \textit{Pi-Car} \textit{raspberry} powered car \cite{rasp}, or 
		\textit{Ghost} car \cite{ghost}, or the \textit{Roscar} \cite{roscar}, or
		the \textit{F1tenth} car \cite{f1tenth}, or the \textit{Donkey} car \cite{donkey}, the architecture
		follows some fundamental principles.
		\\\indent The selection of the hardware is discussed further in the part \vref{hardware}.
		
		\section{Tracking}
		
		Multiple ways of tracking a target exist, in this project the most
		common one was used : a \textit{visual tracking}. Visual tracking
		is basically based on the processing of images or frames taken by a camera. 
		\\\indent More precisely, the mission of the tracker implemented
		in this project is to follow
		a specific object in a frame
		\footnote{Given by a camera for instance.}, to be able to 
		learn the object in that process, and even to be able to recover the target after 
		any occlusion. Looking at the deep learning models and algorithms 
		which have been developed in the recent years,
		some could be more labeled as detection algorithms, do not really learn the specificities 
		of the target, and even track multiple targets. For instance, the network \textit{Yolo} 
		\cite{bjelonicYolo2018} is rather designed for multi-tracking and 		not to follow a specific target. 
		\\\indent Considering deep learning models that are able to 
		track a specific target the database \textit{GOT-10k} has produced
		an enumeration and ranking of the current most effective techniques \cite{trakinglist}.
		\\\indent For sure, in order to automate the robot, a detection algorithm
		could precede the tracking.
		 
		
		\section{Using ROS}
		
		Developing with \textit{ROS} gives also an incredible
		advantage to any roboticist. In fact, some \textit{ROS packages}
		which are totally open-source already provide cutting-edge algorithms
		such as sensor fusion by Kalman filtering, \textit{SLAM}
		\footnote{Simultaneous Localization And Mapping.}. Unfortunately, 
		applied to specific object tracking few \textit{ROS} packages were developed, and
		the existing ones do not use deep learning techniques at all.
		\\\indent Nevertheless, some \textit{ROS interfaces} were implemented
		for \textit{ROS}, which can allow one to use a tracking algorithm
		compatible with the \textit{ROS interface}, also often named
		\textit{bridge} \cite{mtf}. The main problem is mainly that the implemented
		programs are not up-to-date which renders the integration
		in \textit{ROS} sometimes almost impossible due to software dependencies.
		\\\indent Apart from that, several projects, almost all shared on
		\textit{github}, implement tracking solutions. However, they 
		either do not use deep learning, or are not supported by \textit{ROS} 
		anymore. The book \textit{ROS Robotics Projects} presents
		a well-documented tracking project, though no
		deep learning techniques are used \cite{rosprojects}. Yet, 
		the \textit{ROS} architecture inspired some of the realization 
		of the own architecture of this project.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%		

\chapter{Hardware}\label{hardware}

\introductionLettrine{F}{irst} of all, before even thinking about the tracking process, and
the behavior of the robot, the existing platform had to be fixed, and if needed adapted
to the current needs of the project. This part starts by presenting the latest architecture 
of the tracking robot, an then breaks this architecture apart by giving an overview of
each challenge that had to be tackled.
	
	\section{Hardware architecture}
	
		% TODO What do we need to build a robot?
		It is crucial to chose wisely the hardware of the robot in the first place, since
		the software could be seen then as an exploitation of the hardware of 
		the robot. The initial hardware of the robot did comprise
		a \textit{brushed DC motor}\footnote{More is explained 
		on that in the section \vref{motor}.} and a motor controller, or \textit{ESC}, which
		stands for \textit{ Electronic Speed Controller}.
		\\\indent This initial architecture had to be adapted for several reasons.
		The latest hardware architecture of the tracking robot is
		presented on figure \vref{hardwarearchitecture}, which
		shows each component and how each interacts with each other.
		\\\indent Let's explain a bit what are the crucial parts
		that constitute a tracking robot. The target tracking process used
		in this project is based on image and depth inputs, but to be more
		precise, on a \textit{stereo camera}. A \textit{stereo camera}
		provides basically two types of information : depth and color.
		
		\begin{figure}
			\label{hardwarearchitecture}
		\end{figure}

	\section{Low speed control}\label{motor}
	
		\subsection{Motor}
		
		After having fixed the existing \textit{RC car}, the speed was unfortunately 
		too high to meet the likely processing speed of the embedded computer.
		The next step
		was then to find a way to slow down the robot. 
		\\\indent The first constraint was to avoid changing the mechanics as much as
		possible. Changing the gear box, without buying a new \textit{ESC} and a new
		motor could have been possible. Yet, it would have required to alter 
		the entire mechanics of the \textit{RC car} platform. Thus, this option was 
		not considered.
		\\\indent How is it possible then not to modify the mechanics and
		at the same time decreasing the speed? If the mechanics was to 
		be kept identical, that is to say that the power chain should 
		remain untouched, the motor has to remain of the same dimensions.
		This is why as a new motor, a \textit{brushed DC motor} was in part 
		chosen. Taking a 
	
		\subsection{Motor Controller}	
	
	\section{Power consumption}
	
	\section{Remote control and processing}


\chapter{Software}\label{software}

	\section{Tracking}\label{tracking}
	
	\section{ROS}\label{ros}